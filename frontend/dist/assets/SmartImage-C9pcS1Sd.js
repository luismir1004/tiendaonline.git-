import{j as s}from"./state-vendor-C7RdAvCM.js";import{R as p,r as n}from"./react-vendor-2QdgEHnk.js";import{A as x,m as c,L as y,a0 as b}from"./ui-vendor-utBlUGSj.js";const j=e=>{const a=String(e);let t=0;if(!a)return t;for(let i=0;i<a.length;i++){const o=a.charCodeAt(i);t=(t<<5)-t+o,t|=0}return Math.abs(t)},S=e=>{if(!e||!e.id)return"https://picsum.photos/800/1000";const t=String(e.name||"product").replace(/\s+/g,"-").toLowerCase();return`https://picsum.photos/seed/${`${e.id}-${t}`}/800/1000`},w=e=>{const t=j(e?.id||"default")%360,i=(t+60)%360;return`linear-gradient(135deg, hsl(${t}, 20%, 94%) 0%, hsl(${i}, 30%, 96%) 100%)`},I=e=>{if(!e)return{primary:"",backup:"",gradient:"#eee"};const a=S(e);return{primary:Array.isArray(e.images)&&e.images.length>0?e.images[0]:e.image||a,backup:a,gradient:w(e)}},N=e=>`https://picsum.photos/seed/${e}/800/1000`,$=({src:e,alt:a,seedId:t,className:i="",priority:o=!1})=>{const[r,l]=n.useState("loading"),[m,d]=n.useState(e),[f,u]=n.useState(0);n.useEffect(()=>{l("loading"),d(e),u(0)},[e]);const h=()=>{if(f===0&&t){console.warn(`[SmartImage] Primary failed for ${a}. Switching to backup.`);const g=N(t);if(g!==m){d(g),u(1);return}}l("failed")};return s.jsxs("div",{className:`relative w-full h-full overflow-hidden ${i}`,children:[s.jsx(x,{children:r==="loading"&&s.jsx(c.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"absolute inset-0 bg-slate-100 animate-pulse z-20 flex items-center justify-center",children:s.jsx(y,{className:"w-5 h-5 text-slate-300 animate-spin opacity-30"})})}),r!=="failed"&&s.jsx(c.img,{initial:{opacity:0,scale:1.1},animate:{opacity:r==="loaded"?1:0,scale:r==="loaded"?1:1.1},transition:{duration:.7,ease:"easeOut"},src:m,alt:a,loading:o?"eager":"lazy",decoding:"async",onLoad:()=>l("loaded"),onError:h,className:"w-full h-full object-cover will-change-transform"}),r==="failed"&&s.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 flex flex-col items-center justify-center bg-slate-50 p-4 text-center z-10",children:[s.jsx("div",{className:"bg-white p-3 rounded-full shadow-sm mb-2",children:s.jsx(b,{size:20,className:"text-slate-300"})}),s.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:a?.slice(0,20)||"Producto"})]})]})},P=p.memo($);export{P as S,I as r};
